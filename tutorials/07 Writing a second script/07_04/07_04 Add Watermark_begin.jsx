//DESCRIPTION:Add a watermark to each page of the active InDesign file// Add watermark.jsx//// Modified 2015-08-07// Keith Gilbert, Gilbert Consulting// www.gilbertconsulting.com//// The document only contains 1 layer// The page size is large enough to accommodate the watermark text// All the pages in the document are the same sizeMain();// If you want the script to be un-doable, comment out the line above, and remove the comment from the line below// app.doScript(Main, undefined, undefined, UndoModes.ENTIRE_SCRIPT,"Run Script");function Main() {	// Check to see whether any InDesign documents are open.	// If no documents are open, display an error message.	if (app.documents.length > 0) {		var myDoc = app.activeDocument;		// Set up some variables		var myWatermarkText = "SAMPLE"; // Edit this to change the text displayed by the watermark script		var myStartPage = 1; // Edit this to change the starting page 		var myEndPage = 8; // Edit this to change the ending page 		// Create a new layer		var myWatermarkLayer = myDoc.layers.add();		// Memorize the page width and height		var myPageWidth = myDoc.documentPreferences.pageWidth;		var myPageHeight = myDoc.documentPreferences.pageHeight;		// Create a text frame on the first page the same size as the page		var myTextFrame = myDoc.pages[myStartPage-1].textFrames.add();		myTextFrame.geometricBounds = [0,0,myPageHeight,myPageWidth];			myTextFrame.transparencySettings.blendingSettings.opacity = 50;		myTextFrame.textFramePreferences.verticalJustification = VerticalJustification.CENTER_ALIGN;		// Add the text to the frame		myTextFrame.contents = myWatermarkText;		// Format the text		var myText = myTextFrame.paragraphs[0];		myText.appliedFont = app.fonts.item("Minion Pro");		myText.fontStyle = "Regular";		myText.justification = Justification.centerAlign;		myText.pointSize = 100;		myText.fillColor = myDoc.colors.item("Black");		myText.fillTint = 50;				alert("Finished!");	}	else {		// No documents are open, so display an error message.		alert("No InDesign documents are open. Please open a document and try again.");	}}